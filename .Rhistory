empleoaux<-empleoaux[order(empleoaux$fecha),]
View(empleoaux)
vtemp<-rep(empleoaux$templeo[1],monthDays(empleoaux$fecha[1]))
for (i in 2:nrow(dbmeses)){
auxtemp<-rep(empleoaux$templeo[i],monthDays(empleoaux$fecha[i]))
vtemp<-append(vtemp,auxtemp)
}
vtemp<-rep(empleoaux$templeo[1],monthDays(empleoaux$fecha[1]))
for (i in 2:nrow(empleoaux)){
auxtemp<-rep(empleoaux$templeo[i],monthDays(empleoaux$fecha[i]))
vtemp<-append(vtemp,auxtemp)
}
db<-cbind2(db,vtemp)
View(db)
names(db)[5]<-"dia"
names(db)[7]<-"templeo"
vtdesem<-rep(empleoaux$tdesem[1],monthDays(empleoaux$fecha[1]))
for (i in 2:nrow(empleoaux)){
auxtdesem<-rep(empleoaux$tdesem[i],monthDays(empleoaux$fecha[i]))
vtdesem<-append(vtdesem,auxtdesem)
}
db<-cbind2(db,vtdesem)
View(db)
names(db)[8]<-"tdesem"
attach(db)
plot(Fecha,Unidades,type="l")
attach(dbmeses)
View(dbmeses)
View(empleoaux)
dbmeses<-cbind2(dbmeses,empleoaux$templeo)
dbmeses<-cbind2(dbmeses,empleoaux$tdesem)
View(dbmeses)
names(dbmeses)[5]<-"templeo"
names(dbmeses)[6]<-"tdesem"
View(dbmeses)
test<-db%>%group_by(dia)%>%summarise(Unidades=sum(Unidades))
View(test)
#Analizar los datos por mes
mescompra<-db%>%group_by(mes)%>%summarise(Unidades=sum(Unidades))
View(mescompra)
barplot(mescompra$Unidades)
barplot(mescompra$Unidades,mescompra$mes)
barplot(mescompra$mes,mescompra$Unidades)
barplot(mescompra$Unidades)
barplot(db$dia)
table(db$dia)
barplot(table(db$dia))
barplot(mescompra$Unidades)
axis(mescompra$mes)
axis(1,labels=mescompra$mes)
axis(1, at 1:12,labels=mescompra$mes)
axis(1, at=1:12,labels=mescompra$mes)
axis(1, at=1:12=
axis(1, at=1:12)
barplot(mescompra$Unidades)
axis(1, at=1:12)
barplot(mescompra$Unidades)
axis(1, at=1:12,labels=mescompra$mes)
axis(1, at=1:12,labels=mescompra$mes)
axis(1, at=1:12,labels=mescompra$mes)
axis(1, at=1:12,labels=mescompra$mes)
axis(1, at=1:12,labels=mescompra$mes)
axis(1, at=1:12,labels=mescompra$mes)
axis(1, at=1:12,labels=mescompra$mes)
barplot(mescompra$Unidades)
axis(1, at=1:12)
barplot(mescompra$Unidades)
axis(1, at=seq(1, 12, by=1), labels = FALSE)
axis(1, at=seq(1, 12, by=0.5), labels = FALSE)
axis(1, at=seq(1, 12, by=2), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(1, 24, by=2), labels = FALSE)
axis(1, at=seq(1, 20, by=2), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(1, 20, by=2), labels = FALSE)
axis(1, at=seq(1, 20, by=1.2), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(1, 20, by=1.2), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(1, 15, by=1.2), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(1, 14, by=1.2), labels = FALSE)
axis(1, at=seq(1, 15, by=1.2), labels = FALSE)
axis(1, at=seq(1, 15, by=1.3), labels = FALSE)
axis(1, at=seq(0.5, 15, by=1.3), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(0.5, 15, by=1.3), labels = FALSE)
axis(1, at=seq(0.5, 15, by=1.2), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(0.5, 15, by=1.2), labels = FALSE)
axis(1, at=seq(0.5, 14, by=1.25), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(0.5, 14, by=1.25), labels = FALSE)
axis(1, at=seq(0.5, 15, by=1.25), labels = FALSE)
barplot(mescompra$Unidades)
axis(1, at=seq(0.5, 15, by=1.25), labels = FALSE)
barplot(mescompra$Unidades)
axis(labels=dmescompra$mes, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=10,labels=dmescompra$mes, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=10,labels=mescompra$mes, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=12,labels=mescompra$mes, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=1:12,labels=mescompra$mes, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
xx=barplot(mescompra$Unidades)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=1, line=-0.5, cex.axis=0.5)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=1, line=-0.5)
xx=barplot(mescompra$Unidades)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=1, line=-0.5)
xx=barplot(mescompra$Unidades)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=1, line=-0.5, cex.axis=0.5)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=1, line=-0.5)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=1, line=-0.5, cex.axis=0.8)
axis(1, at=xx,labels=mescompra$mes, tick=FALSE, las=1, line=-0.5, cex.axis=0.9)
axis(1, at=xx,labels=c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"), tick=FALSE, las=1, line=-0.5, cex.axis=0.9)
xx=barplot(mescompra$Unidades)
axis(1, at=xx,labels=c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"), tick=FALSE, las=2, line=-0.5, cex.axis=0.9)
# attach(dbmeses)
semanacompra<-db%>%group_by(dia)%>%summarise(Unidades=sum(Unidades))
View(semanacompra)
yy=barplot(semanacompra$Unidades)
axis(1, at=xx,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5, cex.axis=0.9)
yy=barplot(semanacompra$Unidades)
axis(1, at=xx,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5, cex.axis=0.9)
axis(1, at=yy,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5, cex.axis=0.9)
semanacompra$dia <- factor(semanacompra, levels= c("Sunday", "Monday",
"Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
semanacompra$dia <- factor(semanacompra$dia, levels= c("lunes", "martes",
"miércoles", "jueves", "viernes", "sábado", "domingo"))
View(semanacompra)
View(semanacompra)
semanacompra$dia <- factor(semanacompra$dia, levels= c("lunes", "martes","miércoles", "jueves", "viernes", "sábado", "domingo"))
View(semanacompra)
semanacompra[order(semanacompra$dia), ]
semanacompra<-semanacompra[order(semanacompra$dia), ]
View(semanacompra)
semanacompra<-db%>%group_by(dia)%>%summarise(Unidades=sum(Unidades))
semanacompra$dia <- factor(semanacompra$dia, levels= c("lunes", "martes","miércoles", "jueves", "viernes", "sábado", "domingo"))
semanacompra<-semanacompra[order(semanacompra$dia), ]
yy=barplot(semanacompra$Unidades)
axis(1, at=yy,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5, cex.axis=0.9)
axis(1, at=yy,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5)
yy=barplot(semanacompra$Unidades)
axis(1, at=yy,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5)
View(dbmeses)
attach(dbmeses)
plot(mes,pop)
plot(mes,pop,type="l")
plot(mes,TRM,type="l")
plot(mes,pop,type="l")
plot(mes,TRM,type="l")
plot(mes,pop,type="l")
plot(mes,TRM,type="l")
plot(mes,pop,type="l")
plot(mes,uni,type="l")
plot(mes,pop,type="l")
plot(mes,uni,type="l")
plot(mes,pop,type="l")
plot(mes,pop,type="l")
plot(mes,uni,type="l")
par(mfrow=c(2,1))
plot(mes,uni,type="l")
par(mfrow=c(1,2))
plot(mes,uni,type="l")
plot(mes,pop,type="l")
par(mfrow=c(3,2))
plot(mes,TRM,type="l")
plot(mes,uni,type="l")
plot(mes,pop,type="l")
plot(mes,templeo,type="l")
plot(mes,tdesem,type="l")
# plot(mes,uni,type="l",col="red",lwd=2)
par(mfrow=c(3,2))
plot(mes,TRM,type="l")
plot(mes,uni,type="l",ylab="Unidades")
plot(mes,pop,type="l",ylab="Popularidad")
plot(mes,templeo,type="l",ylab="Tasa de empleo")
plot(mes,tdesem,type="l",ylab="Tasa de desempleo")
plot(mes,TRM,type="l",xlim=c(2012-01-01,2012-12-01))
plot(mes,TRM,type="l",xlim=c("2012-01-01","2012-12-01"))
plot(mes,TRM,type="l",xlim=as.Date(c("2012-01-01","2012-12-01"))
)
plot(mes,TRM,type="l",xlim=as.Date(c("2012-01-01","2013-12-01"))
)
plot(mes,uni,type="l",xlim=as.Date(c("2012-01-01","2012-12-01")))
# plot(mes,uni,type="l",col="red",lwd=2)
par(mfrow=c(3,2))
plot(mes,TRM,type="l")
plot(mes,uni,type="l",ylab="Unidades")
plot(mes,pop,type="l",ylab="Popularidad")
plot(mes,templeo,type="l",ylab="Tasa de empleo")
plot(mes,tdesem,type="l",ylab="Tasa de desempleo")
attach(db)
modelo1<-glm(Unidades~TRM+mes+dia+pop+templeo+tdesem,poisson)
View(modelo1)
summary(modelo1)
modelo1<-lm(Unidades~TRM+mes+dia+pop+templeo+tdesem)
summary(modelo1)
ipc<-read.csv2("ipc.csv",header=T)
View(ipc)
str(ipc)
ipc<-read.csv2("ipc.csv",header=T)
View(ipc)
names(ipc)[5]<-"varanual"
View(ipc)
dbmeses[1]
ipc<-ipc[-3]
View(ipc)
ipc<-ipc[-3]
ipc$fecha<-as.Date(paste(ipc$fecha,1,sep="-"),"%Y-%m-%d")
dbmeses<-cbind2(dbmeses,ipc$IPC)
dbmeses<-cbind2(dbmeses,ipc$varanual)
View(dbmeses)
names(dbmeses)[7]<-"IPC"
names(dbmeses)[8]<-"varanualipc"
View(dbmeses)
vipc<-rep(ipc$IPC[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxipc<-rep(ipc$IPC[i],monthDays(ipc$fecha[i]))
vipc<-append(vipc,auxipc)
}
db<-cbind2(db,vipc)
View(db)
View(db)
vvaripc<-rep(ipc$varanual[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxvaripc<-rep(ipc$varanual[i],monthDays(ipc$fecha[i]))
vvaripc<-append(vvaripc,auxvaripc)
}
db<-cbind2(db,vvaripc)
View(db)
ipc$varanual=gsub("\\%", "", ipc$varanual)
View(ipc)
str(ipc)
ipc$varanual<-as.numeric(ipc$varanual)
View(ipc)
View(ipc)
View(ipc)
ipc<-read.csv2("ipc.csv",header=T)
ipc<-ipc[-3]
ipc<-ipc[-3]
View(ipc)
names(ipc)[3]<-"varanual"
ipc$fecha<-as.Date(paste(ipc$fecha,1,sep="-"),"%Y-%m-%d")
dbmeses<-cbind2(dbmeses,ipc$IPC)
dbmeses<-cbind2(dbmeses,ipc$varanual)
names(dbmeses)[7]<-"IPC"
names(dbmeses)[8]<-"varanualipc"
ipc$varanual=gsub("\\%", "", ipc$varanual)
ipc$varanual=as.numeric(gsub("\\,", ".", ipc$varanual))
View(ipc)
str8ipc
str(ipc)
ipc$fecha<-as.Date(paste(ipc$fecha,1,sep="-"),"%Y-%m-%d")
dbmeses<-cbind2(dbmeses,ipc$IPC)
dbmeses<-cbind2(dbmeses,ipc$varanual)
names(dbmeses)[7]<-"IPC"
names(dbmeses)[8]<-"varanualipc"
ipc$varanual=gsub("\\%", "", ipc$varanual)
ipc$varanual=as.numeric(gsub("\\,", ".", ipc$varanual))
vipc<-rep(ipc$IPC[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxipc<-rep(ipc$IPC[i],monthDays(ipc$fecha[i]))
vipc<-append(vipc,auxipc)
}
db<-cbind2(db,vipc)
names(db)[9]<-"ipc"
vvaripc<-rep(ipc$varanual[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxvaripc<-rep(ipc$varanual[i],monthDays(ipc$fecha[i]))
vvaripc<-append(vvaripc,auxvaripc)
}
db<-cbind2(db,vvaripc)
View(db)
rm(list=ls())
library(dplyr)
library(Hmisc)
library(lubridate)
setwd("D:/Documents/GitHub/Trabajo2")
db <- read.csv2("Autos TRM.csv",header = TRUE,stringsAsFactors = FALSE)
db$Fecha <- as.Date(db$Fecha, format = "%d/%m/%Y") #Formating the date
db$TRM=gsub("\\$", "", db$TRM)
db$TRM=gsub("\\.", "", db$TRM)
db$TRM=as.numeric(gsub("\\,", ".", db$TRM))
db<-cbind2(db,month(db$Fecha))
db<-cbind2(db,weekdays(db$Fecha))
names(db)[4]<-"mes"
names(db)[5]<-"dia"
#Creación de dataframe por meses
attach(db)
dbmeses<-db%>%group_by(Mes=floor_date(Fecha,"month"))%>%summarise(Unidades=sum(Unidades),TRM=mean(TRM))
dbmeses$Mes<-as.Date(dbmeses$Mes)
googleaux<-read.csv2("multiTimeline (1).csv",header=T,sep=",")
dbmeses<-cbind2(dbmeses,googleaux$carro...Colombia.)
names(dbmeses)[2]<-"uni"
names(dbmeses)[4]<-"pop"
names(dbmeses)[1]<-"mes"
#Incluir popularidad en el dataframe por día
vpop<-rep(dbmeses$pop[1],monthDays(dbmeses$mes[1]))
for (i in 2:nrow(dbmeses)){
auxpop<-rep(dbmeses$pop[i],monthDays(dbmeses$mes[i]))
vpop<-append(vpop,auxpop)
}
db<-cbind2(db,vpop)
names(db)[6]<-"pop"
empleoaux<-read.csv2("Empleo_desempleo.csv",header=FALSE,stringsAsFactors = FALSE)
names(empleoaux)[1]<-"fecha"
names(empleoaux)[2]<-"templeo"
names(empleoaux)[3]<-"tdesem"
empleoaux$fecha<-as.Date(paste(empleoaux$fecha,1,sep="-"),"%Y-%m-%d")
empleoaux<-empleoaux[order(empleoaux$fecha),]
dbmeses<-cbind2(dbmeses,empleoaux$templeo)
dbmeses<-cbind2(dbmeses,empleoaux$tdesem)
#Incluir tasa de empleo
vtemp<-rep(empleoaux$templeo[1],monthDays(empleoaux$fecha[1]))
for (i in 2:nrow(empleoaux)){
auxtemp<-rep(empleoaux$templeo[i],monthDays(empleoaux$fecha[i]))
vtemp<-append(vtemp,auxtemp)
}
db<-cbind2(db,vtemp)
names(db)[7]<-"templeo"
#Incluir tasa de desempleo
vtdesem<-rep(empleoaux$tdesem[1],monthDays(empleoaux$fecha[1]))
for (i in 2:nrow(empleoaux)){
auxtdesem<-rep(empleoaux$tdesem[i],monthDays(empleoaux$fecha[i]))
vtdesem<-append(vtdesem,auxtdesem)
}
db<-cbind2(db,vtdesem)
names(db)[8]<-"tdesem"
#Analizar los datos por día de la semana
semanacompra<-db%>%group_by(dia)%>%summarise(Unidades=sum(Unidades))
semanacompra$dia <- factor(semanacompra$dia, levels= c("lunes", "martes","miércoles", "jueves", "viernes", "sábado", "domingo"))
semanacompra<-semanacompra[order(semanacompra$dia), ]
#Análisis por día de la semana
yy=barplot(semanacompra$Unidades)
axis(1, at=yy,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5)
#Analizar los datos por mes
mescompra<-db%>%group_by(mes)%>%summarise(Unidades=sum(Unidades))
#Análisis de meses y compras
xx=barplot(mescompra$Unidades)
axis(1, at=yy,labels=c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"), tick=FALSE, las=2, line=-0.5, cex.axis=0.9)
#Análisis del dólar y de los carros registrados por meses(evasión de ruido promediando)
attach(dbmeses)
# plot(mes,uni,type="l",col="red",lwd=2)
par(mfrow=c(3,2))
plot(mes,TRM,type="l")
plot(mes,uni,type="l",ylab="Unidades")
plot(mes,pop,type="l",ylab="Popularidad")
plot(mes,templeo,type="l",ylab="Tasa de empleo")
plot(mes,tdesem,type="l",ylab="Tasa de desempleo")
modelo1<-lm(Unidades~TRM+mes+dia+pop+templeo+tdesem)
#IPC
ipc<-read.csv2("ipc.csv",header=T)
ipc<-ipc[-3]
ipc<-ipc[-3]
names(ipc)[3]<-"varanual"
ipc$fecha<-as.Date(paste(ipc$fecha,1,sep="-"),"%Y-%m-%d")
dbmeses<-cbind2(dbmeses,ipc$IPC)
dbmeses<-cbind2(dbmeses,ipc$varanual)
names(dbmeses)[7]<-"IPC"
names(dbmeses)[8]<-"varanualipc"
ipc$varanual=gsub("\\%", "", ipc$varanual)
ipc$varanual=as.numeric(gsub("\\,", ".", ipc$varanual))
vipc<-rep(ipc$IPC[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxipc<-rep(ipc$IPC[i],monthDays(ipc$fecha[i]))
vipc<-append(vipc,auxipc)
}
db<-cbind2(db,vipc)
names(db)[9]<-"ipc"
vvaripc<-rep(ipc$varanual[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxvaripc<-rep(ipc$varanual[i],monthDays(ipc$fecha[i]))
vvaripc<-append(vvaripc,auxvaripc)
}
db<-cbind2(db,vvaripc)
View(db)
names(db)[10]<-"varanualipc"
rm(list=ls())
library(dplyr)
library(Hmisc)
library(lubridate)
setwd("D:/Documents/GitHub/Trabajo2")
db <- read.csv2("Autos TRM.csv",header = TRUE,stringsAsFactors = FALSE)
db$Fecha <- as.Date(db$Fecha, format = "%d/%m/%Y") #Formating the date
db$TRM=gsub("\\$", "", db$TRM)
db$TRM=gsub("\\.", "", db$TRM)
db$TRM=as.numeric(gsub("\\,", ".", db$TRM))
db<-cbind2(db,month(db$Fecha))
db<-cbind2(db,weekdays(db$Fecha))
names(db)[4]<-"mes"
names(db)[5]<-"dia"
#Creación de dataframe por meses
attach(db)
dbmeses<-db%>%group_by(Mes=floor_date(Fecha,"month"))%>%summarise(Unidades=sum(Unidades),TRM=mean(TRM))
dbmeses$Mes<-as.Date(dbmeses$Mes)
googleaux<-read.csv2("multiTimeline (1).csv",header=T,sep=",")
dbmeses<-cbind2(dbmeses,googleaux$carro...Colombia.)
names(dbmeses)[2]<-"uni"
names(dbmeses)[4]<-"pop"
names(dbmeses)[1]<-"mes"
#Incluir popularidad en el dataframe por día
vpop<-rep(dbmeses$pop[1],monthDays(dbmeses$mes[1]))
for (i in 2:nrow(dbmeses)){
auxpop<-rep(dbmeses$pop[i],monthDays(dbmeses$mes[i]))
vpop<-append(vpop,auxpop)
}
db<-cbind2(db,vpop)
names(db)[6]<-"pop"
empleoaux<-read.csv2("Empleo_desempleo.csv",header=FALSE,stringsAsFactors = FALSE)
names(empleoaux)[1]<-"fecha"
names(empleoaux)[2]<-"templeo"
names(empleoaux)[3]<-"tdesem"
empleoaux$fecha<-as.Date(paste(empleoaux$fecha,1,sep="-"),"%Y-%m-%d")
empleoaux<-empleoaux[order(empleoaux$fecha),]
dbmeses<-cbind2(dbmeses,empleoaux$templeo)
dbmeses<-cbind2(dbmeses,empleoaux$tdesem)
#Incluir tasa de empleo
vtemp<-rep(empleoaux$templeo[1],monthDays(empleoaux$fecha[1]))
for (i in 2:nrow(empleoaux)){
auxtemp<-rep(empleoaux$templeo[i],monthDays(empleoaux$fecha[i]))
vtemp<-append(vtemp,auxtemp)
}
db<-cbind2(db,vtemp)
names(db)[7]<-"templeo"
#Incluir tasa de desempleo
vtdesem<-rep(empleoaux$tdesem[1],monthDays(empleoaux$fecha[1]))
for (i in 2:nrow(empleoaux)){
auxtdesem<-rep(empleoaux$tdesem[i],monthDays(empleoaux$fecha[i]))
vtdesem<-append(vtdesem,auxtdesem)
}
db<-cbind2(db,vtdesem)
names(db)[8]<-"tdesem"
#Analizar los datos por día de la semana
semanacompra<-db%>%group_by(dia)%>%summarise(Unidades=sum(Unidades))
semanacompra$dia <- factor(semanacompra$dia, levels= c("lunes", "martes","miércoles", "jueves", "viernes", "sábado", "domingo"))
semanacompra<-semanacompra[order(semanacompra$dia), ]
#Análisis por día de la semana
yy=barplot(semanacompra$Unidades)
axis(1, at=yy,labels=semanacompra$dia, tick=FALSE, las=2, line=-0.5)
#Analizar los datos por mes
mescompra<-db%>%group_by(mes)%>%summarise(Unidades=sum(Unidades))
#Análisis de meses y compras
xx=barplot(mescompra$Unidades)
axis(1, at=yy,labels=c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"), tick=FALSE, las=2, line=-0.5, cex.axis=0.9)
#Análisis del dólar y de los carros registrados por meses(evasión de ruido promediando)
attach(dbmeses)
# plot(mes,uni,type="l",col="red",lwd=2)
par(mfrow=c(3,2))
plot(mes,TRM,type="l")
plot(mes,uni,type="l",ylab="Unidades")
plot(mes,pop,type="l",ylab="Popularidad")
plot(mes,templeo,type="l",ylab="Tasa de empleo")
plot(mes,tdesem,type="l",ylab="Tasa de desempleo")
#IPC
ipc<-read.csv2("ipc.csv",header=T)
ipc<-ipc[-3]
ipc<-ipc[-3]
names(ipc)[3]<-"varanual"
ipc$fecha<-as.Date(paste(ipc$fecha,1,sep="-"),"%Y-%m-%d")
dbmeses<-cbind2(dbmeses,ipc$IPC)
dbmeses<-cbind2(dbmeses,ipc$varanual)
names(dbmeses)[7]<-"IPC"
names(dbmeses)[8]<-"varanualipc"
ipc$varanual=gsub("\\%", "", ipc$varanual)
ipc$varanual=as.numeric(gsub("\\,", ".", ipc$varanual))
vipc<-rep(ipc$IPC[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxipc<-rep(ipc$IPC[i],monthDays(ipc$fecha[i]))
vipc<-append(vipc,auxipc)
}
db<-cbind2(db,vipc)
names(db)[9]<-"ipc"
vvaripc<-rep(ipc$varanual[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxvaripc<-rep(ipc$varanual[i],monthDays(ipc$fecha[i]))
vvaripc<-append(vvaripc,auxvaripc)
}
db<-cbind2(db,vvaripc)
names(db)[10]<-"varanualipc"
View(db)
View(ipc)
str(ipc)
dbmeses<-cbind2(dbmeses,ipc$PromGaso)
names(dbmeses)[7]<-"IPC"
names(dbmeses)[8]<-"varanualipc"
names(dbmeses)[9]<-"PromGaso"
View(dbmeses)
View(ipc)
vpromgaso<-rep(ipc$PromGaso[1],monthDays(ipc$fecha[1]))
for (i in 2:nrow(ipc)){
auxvaripc<-rep(ipc$PromGaso[i],monthDays(ipc$fecha[i]))
vpromgaso<-append(vpromgaso,auxvaripc)
}
db<-cbind2(db,vpromgaso)
names(db)[11]<-"Promgaso"
View(db)
attach(db)
View(db)
modelo1<-lm(Unidades~TRM+mes+dia+pop+templeo+tdesem+ipc+varanualipc+Promgaso)
str(db)
names(db)[9]<-"IPC"
modelo1<-lm(Unidades~TRM+mes+dia+pop+templeo+tdesem+IPC+varanualipc+Promgaso)
attach(db)
modelo1<-lm(Unidades~TRM+mes+dia+pop+templeo+tdesem+IPC+varanualipc+Promgaso)
summary(modelo1)
modelo1<-lm(Unidades~TRM+mes+dia+pop+templeo+tdesem)
summary(modelo1)
modelo1<-glm(Unidades~TRM+mes+dia+pop+templeo+tdesem,poisson)
modelo1
View(modelo1)
modelo1$deviance
1-(modelo1$deviance/modelo1$null.deviance)
